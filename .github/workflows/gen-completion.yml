name: Generate ohmyzsh completion
on:
  push:
    branches:
      - main
      - release/v*
jobs:
  gen-completion-and-push:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - uses: actions/setup-go@v5
        with:
          go-version: "1.20"
          check-latest: true
      - name: Generate completion file
        run: make gen-completion
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          commit-message: Add ohmyzsh completion plugin
          title: "chore: update ohmyzsh completion plugin"
          body: >
            This PR is auto-generated by 
            [create-pull-request](https://github.com/peter-evans/create-pull-request).
          labels: automated pr
